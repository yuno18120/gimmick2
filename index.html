<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <canvas id="mycanvas"></canvas>
    <h1 id="t1"></h1>
    <h1 id="t2"></h1>

    <script>

        window.addEventListener("devicemotion", deviceMotion);

        let canvas = document.getElementById("mycanvas");
        let c = canvas.getContext("2d");

        let x = 0;  //加速度を格納する
        let ballX = 30;
        let ballY = 30;
        let ballSize = 20;
        let v = 1;

        let stage =
            [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [1, 1, 1, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
            [0, 0, 1, 1, 1, 1, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 1, 1, 0, 0, 0],
            [0, 0, 0, 0, 0, 0, 1, 1, 1, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 1, 1],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            ]

        function setsize() {
            canvas.width = document.documentElement.clientWidth - 15;
            canvas.height = document.documentElement.clientHeight - 20;
        }

        /*function drawstage(){
            for(let i=0; i<stage.length; i++){
                for(let j=0; j<stage[i].length; j++){
                    if(stage[i][j] == 1){
                        c.beginPath();
                        c.rect(canvas.width/(stage[i].length)*j,canvas.height/(stage.length)*i,canvas.width/(stage[i].length),canvas.height/(stage.length));
                        c.fillStyle = "white";
                        c.strokeStyle = "white";
                        c.fill();
                        c.closePath();
                    }else if(stage[i][j] == 0){
                        c.beginPath();
                        c.rect(canvas.width/(stage[i].length)*j,canvas.height/(stage.length)*i,canvas.width/(stage[i].length),canvas.height/(stage.length));
                        c.fillStyle = "black";
                        c.strokeStyle = "black";
                        c.fill();
                        c.closePath();
                    }
                }
            }
        }*/

        function main() {
            //drawstage();

            // 背景を描画
            c.beginPath();
            c.rect(0, 0, canvas.width, canvas.height);
            c.fillStyle = "white";
            c.fill();
            c.closePath();

            // ボールを描画
            c.beginPath();
            c.arc(ballX, ballY, ballSize, 0, Math.PI * 2);
            c.fillStyle = "black";
            c.fill();
            c.closePath();

            // ボールの動く範囲を制限
            if(ballX >= canvas.width-ballSize || ballX <= 0+ballSize){
                ballX = 30;
            }
            if(ballY >= canvas.height-ballSize || ballY <= 0+ballSize){
                ballY = 30;
            }

            //速度を計算
            ballX += v * (x * (-1));
            ballY += v * y;
        }

        function deviceMotion(e) {
            x = e.accelerationIncludingGravity.x;
            y = e.accelerationIncludingGravity.y;
            if (Math.abs(x) <= 0.1) {
                x = 0;
            }
            if (Math.abs(y) <= 0.1) {
                y = 0;
            }
        }

        setsize();

        setInterval(main, 1);
    </script>
</body>

</html>